---
id: KB-RU-000199
title: "Процедуры обработки данных подшипников"
topic: "podshipniki-playbooks"
tags: ["подшипники", "процедуры", "пайплайн", "автоматизация"]
status: draft
source: "kb/ru/podshipniki/README.md"
created: "2026-02-07"
updated: "2026-02-07"
---

# Процедуры обработки данных подшипников

Пошаговые инструкции для обработки данных, создания статей и обслуживания базы знаний по подшипникам.

## Контекст применения

- Загрузка новых данных в базу знаний
- Обработка каталогов производителей
- Создание и обновление карточек подшипников
- Валидация и проверка качества данных
- Архивирование обработанных материалов

## Основной пайплайн

Согласно ТЗ (KB-RU-000180), обработка данных включает следующие этапы:

```
1. Intake → 2. Дедупликация → 3. Разбор → 4. Создание статей → 
5. Датасеты → 6. Индексы → 7. Валидация → 8. Архив
```

## Процедура 1: Intake (Загрузка данных)

### Назначение
Принять новый материал в базу знаний без ручной сортировки.

### Входные данные
- Каталоги производителей (PDF, MD, HTML)
- Прайс-листы (XLSX, CSV)
- Стандарты (PDF)
- Технические описания

### Шаги

1. **Положить файл в inbox/**
   ```bash
   cp /path/to/новый-каталог.pdf inbox/
   ```

2. **Не сортировать вручную**
   - Не создавать подпапки
   - Не переименовывать файлы
   - Файл остается в корне inbox/

3. **Зафиксировать дату поступления**
   - Дата загрузки = дата создания файла в inbox/
   - Используется для архивирования

### Выход
- Файл в inbox/ готов к обработке

### Примечания
- Допустимые форматы: MD, PDF, XLSX, CSV, HTML, TXT
- Максимальный размер файла: 100 MB
- Кодировка текстовых файлов: UTF-8

---

## Процедура 2: Дедупликация

### Назначение
Предотвратить дублирование контента в базе знаний.

### Входные данные
- Файл в inbox/
- _meta/dedup_index.json (индекс дедупликации)

### Шаги

1. **Вычислить sha256 содержимого**
   ```bash
   sha256sum inbox/новый-файл.pdf
   ```

2. **Проверить в _meta/dedup_index.json**
   ```bash
   grep "полученный-хеш" _meta/dedup_index.json
   ```

3. **Если дубликат найден**:
   - Записать в `_meta/dedup_log.md`:
     ```markdown
     ## 2026-02-07
     - Файл: новый-файл.pdf
     - SHA256: abc123...
     - Дубликат: старый-файл.pdf
     - Действие: Пропущен
     ```
   - НЕ публиковать новую статью
   - Переместить в `inbox/duplicates/`

4. **Если дубликата нет**:
   - Добавить в `_meta/dedup_index.json`:
     ```json
     {
       "sha256": "abc123...",
       "file": "новый-файл.pdf",
       "date": "2026-02-07"
     }
     ```
   - Продолжить обработку

### Выход
- Уникальный файл готов к разбору
- Дубликат зафиксирован в логе

### Примечания
- Хеш вычисляется от содержимого, не от имени файла
- _meta/dedup_index.json обновляется после каждой проверки

---

## Процедура 3: Разбор и декомпозиция

### Назначение
Разложить материал на статьи, карточки и датасеты.

### Входные данные
- Уникальный файл из inbox/
- Существующие датасеты в kb/ru/bearings/datasets/

### Шаги

1. **Определить тип материала**:
   - Каталог производителя → nomenclature.csv + manufacturers.csv
   - Прайс-лист → price-list паспорт
   - Техническая статья → статья в concepts/
   - Стандарт → статья в bearings/standards/

2. **Извлечь данные** (для каталога производителя):
   ```bash
   # Если MD файл с таблицей
   # Пример: inbox/SKF.md → извлечь строки таблицы
   ```

3. **Выделить сущности**:
   - Подшипники (обозначение, размеры, грузоподъёмность)
   - Производитель (название, страна, особенности)
   - Эквиваленты (ГОСТ ↔ международные)

4. **Привязать к существующим датасетам**:
   - Добавить в nomenclature.csv
   - Обновить manufacturers.csv
   - Дополнить equivalents.csv при наличии соответствий

### Выход
- Структурированные данные готовы к загрузке в CSV
- Список новых сущностей

---

## Процедура 4: Создание/обновление статей

### Назначение
Создать или обновить статьи в базе знаний.

### Входные данные
- Структурированные данные
- _templates/article.md или _templates/bearing-card.md

### Шаги

1. **Определить следующий ID**
   ```bash
   grep -r "^id: KB-RU-" kb/ru/ | sed 's/.*KB-RU-//' | sort -n | tail -1
   # Текущий максимум: 000196
   # Следующий ID: 000197
   ```

2. **Создать папку и README.md**
   ```bash
   mkdir -p kb/ru/podshipniki/concepts/новая-тема
   cp _templates/article.md kb/ru/podshipniki/concepts/новая-тема/README.md
   ```

3. **Заполнить метаданные**
   ```yaml
   ---
   id: KB-RU-000200
   title: "Название статьи"
   topic: "podshipniki-новая-тема"
   tags: ["подшипники", "тег1", "тег2"]
   status: draft
   source: "inbox/исходный-файл.pdf"  # Указать источник!
   created: "2026-02-07"
   updated: "2026-02-07"
   ---
   ```

4. **Заполнить содержание**
   - Использовать данные ТОЛЬКО из источника
   - Не добавлять информацию "из головы"
   - Фиксировать TBD для недостающих данных

### Выход
- Статья создана с корректными метаданными
- Поле source указывает на исходный файл

---

## Процедура 5: Карточки и датасеты

### Назначение
Обновить структурированные данные и сгенерировать карточки подшипников.

### Входные данные
- Данные о подшипниках
- kb/ru/bearings/datasets/catalog.csv

### Шаги

1. **Обновить catalog.csv**
   ```csv
   designation,type,d_mm,D_mm,B_mm,dynamic_C_kN,static_C0_kN,rpm_limit,mass_kg
   6306,ball_deep_groove,30,72,19,28.1,15.3,9500,0.23
   ```

2. **Обновить nomenclature.csv** (если есть эквиваленты)
   ```csv
   gost_designation,analog,manufacturer,source_url,source_file
   180306,6306,SKF,https://...,SKF.md
   ```

3. **Сгенерировать карточки**
   ```bash
   python scripts/generate_bearing_cards.py \
     --catalog kb/ru/bearings/datasets/catalog.csv \
     --equivalents kb/ru/bearings/datasets/equivalents.csv \
     --output-dir kb/ru/bearings/cards/ \
     --id-start 000200
   ```

4. **Обновить паспорт датасета**
   - Отредактировать kb/ru/bearings/datasets/README.md
   - Указать источник обновления
   - Зафиксировать дату актуальности

### Выход
- Датасеты обновлены
- Карточки сгенерированы
- Паспорт документирован

---

## Процедура 6: Обновление индексов

### Назначение
Связать новые статьи с индексами для навигации.

### Входные данные
- Новые статьи в kb/ru/podshipniki/
- kb/ru/INDEX.md, kb/ru/podshipniki/INDEX.md

### Шаги

1. **Обновить kb/ru/podshipniki/INDEX.md**
   ```markdown
   ## Концепции
   - [Новая тема](./concepts/новая-тема/README.md)
   ```

2. **Обновить kb/ru/INDEX.md** (если раздел важный)
   ```markdown
   ### Подшипники
   - [Новая тема](./podshipniki/concepts/новая-тема/README.md)
   ```

3. **Обновить тематические листы**:
   - kb/ru/bearings/INDEX.md (для карточек подшипников)
   - kb/ru/bearings-knowledge-base/README.md (для процессов)

### Выход
- Все индексы актуализированы
- Навигация работает корректно

---

## Процедура 7: Валидация

### Назначение
Проверить качество данных и отсутствие ошибок.

### Входные данные
- Обновленная база знаний

### Шаги

1. **Проверить ссылки**
   ```bash
   python tests/check_kb_links.py
   ```

2. **Проверить метаданные**
   ```bash
   python scripts/kb_quality_gate.py
   ```

3. **Проверить карточки подшипников** (если создавались)
   ```bash
   python scripts/validate_bearing_cards.py
   ```

4. **Исправить ошибки**:
   - Битые ссылки → обновить пути
   - Дублирующиеся ID → назначить новые
   - Некорректные метаданные → исправить YAML

5. **Повторить валидацию**
   - Пока все проверки не пройдут успешно

### Выход
- Все валидации пройдены
- База знаний в консистентном состоянии

---

## Процедура 8: Архивирование сырья

### Назначение
Переместить обработанные файлы для сохранения трассировки.

### Входные данные
- Обработанный файл в inbox/

### Шаги

1. **Создать папку архива**
   ```bash
   mkdir -p inbox/processed/YYYY-MM/
   # Например: inbox/processed/2026-02/
   ```

2. **Переместить файл**
   ```bash
   mv inbox/исходный-файл.pdf inbox/processed/2026-02/
   ```

3. **Сохранить имя для трассировки**
   - Имя файла остается неизменным
   - Поле `source` в статьях указывает на этот файл

4. **Не удалять файлы из processed/**
   - Архив необходим для трассировки
   - При необходимости можно сжать старые архивы

### Выход
- inbox/ очищен
- Файл архивирован в inbox/processed/YYYY-MM/
- Трассировка сохранена

---

## Частые ошибки

- **Пропуск дедупликации**: приводит к дублированию статей
- **Отсутствие source**: нарушается трассировка источников
- **Неправильный ID**: дублирование или пропуски в нумерации
- **Пропуск валидации**: накопление битых ссылок и ошибок
- **Удаление файлов из processed/**: потеря трассировки

## См. также

- [Техническое задание](../README.md) — полное описание пайплайна
- [Наборы данных](../datasets/README.md) — структура CSV файлов
- [Концепции](../concepts/README.md) — организация знаний
- [Карточки подшипников](../cards/README.md) — генерация карточек

## Источники и примечания

- Source: `kb/ru/podshipniki/README.md (алгоритм/шаги)`
- Notes: Процедуры основаны на фактическом пайплайне, использованном для обработки 85 файлов производителей и создания nomenclature.csv

## Контроль качества

- [x] Есть метаданные (id/topic/status/source)
- [x] Понятно без внешнего контекста
- [x] Есть примеры использования
- [x] Нет противоречий
- [x] Есть 3–7 ссылок «См. также»
- [ ] Для `status: verified` нет `[[TBD]]`
